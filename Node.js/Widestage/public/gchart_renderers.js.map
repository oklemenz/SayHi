{"version":3,"sources":["gchart_renderers.coffee"],"names":[],"mappings":"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","file":"gchart_renderers.js","sourceRoot":"/source/","sourcesContent":["callWithJQuery = (pivotModule) ->\n    if typeof exports is \"object\" and typeof module is \"object\" # CommonJS\n        pivotModule require(\"jquery\")\n    else if typeof define is \"function\" and define.amd # AMD\n        define [\"jquery\"], pivotModule\n    # Plain browser env\n    else\n        pivotModule jQuery\n        \ncallWithJQuery ($) ->\n\n    makeGoogleChart = (chartType, extraOptions) -> (pivotData, opts) ->\n        defaults =\n            localeStrings:\n                vs: \"vs\"\n                by: \"by\"\n\n        opts = $.extend defaults, opts\n\n        rowKeys = pivotData.getRowKeys()\n        rowKeys.push [] if rowKeys.length == 0\n        colKeys = pivotData.getColKeys()\n        colKeys.push [] if colKeys.length == 0\n\n        headers = (h.join(\"-\") for h in rowKeys)\n        headers.unshift \"\"\n\n        numCharsInHAxis = 0\n        dataArray = [headers]\n        for colKey in colKeys\n            row = [colKey.join(\"-\")]\n            numCharsInHAxis += row[0].length\n            for rowKey in rowKeys\n                agg = pivotData.getAggregator(rowKey, colKey)\n                if agg.value()?\n                    row.push agg.value()\n                else row.push null\n            dataArray.push row\n\n        title = vAxisTitle = pivotData.aggregatorName+ \n            if pivotData.valAttrs.length then \"(#{pivotData.valAttrs.join(\", \")})\" else \"\"\n        hAxisTitle = pivotData.colAttrs.join(\"-\")\n        title += \" #{opts.localeStrings.vs} #{hAxisTitle}\" if hAxisTitle != \"\"\n        groupByTitle = pivotData.rowAttrs.join(\"-\")\n        title += \" #{opts.localeStrings.by} #{groupByTitle}\" if groupByTitle != \"\"\n\n        options = \n            width: $(window).width() / 1.4\n            height: $(window).height() / 1.4\n            title: title\n            hAxis: {title: hAxisTitle, slantedText: numCharsInHAxis > 50}\n            vAxis: {title: vAxisTitle}\n\n        if dataArray[0].length == 2 and dataArray[0][1] ==  \"\"\n            options.legend = position: \"none\"\n\n        options[k] = v for k, v of extraOptions\n\n        dataTable = google.visualization.arrayToDataTable(dataArray)\n\n        result = $(\"<div>\").css(width: \"100%\", height: \"100%\")\n        wrapper = new google.visualization.ChartWrapper {dataTable, chartType, options}\n        wrapper.draw(result[0])    \n        result.bind \"dblclick\", -> \n            editor = new google.visualization.ChartEditor()\n            google.visualization.events.addListener editor, 'ok', -> \n                editor.getChartWrapper().draw(result[0])\n            editor.openDialog(wrapper)\n        return result\n\n    $.pivotUtilities.gchart_renderers = \n        \"Line Chart\": makeGoogleChart(\"LineChart\")\n        \"Bar Chart\": makeGoogleChart(\"ColumnChart\")\n        \"Stacked Bar Chart\": makeGoogleChart(\"ColumnChart\", isStacked: true)\n        \"Area Chart\": makeGoogleChart(\"AreaChart\", isStacked: true)\n"]}